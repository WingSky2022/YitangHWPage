<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,viewport-fit=cover">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache,no-store,must-revalidate">
<meta http-equiv="Expires" content="0">
<title>ä¸€å ‚ä½œä¸šç³»ç»Ÿ - ç¦»çº¿ç‰ˆæœ¬</title>
<style>
/* ===== åŸºç¡€CSSé‡ç½®å’Œå˜é‡ ===== */
:root {
  /* åŸºç¡€é¢œè‰² - äº®è‰²ä¸»é¢˜ */
  --color-primary: #fad200;
  --color-primary-rgb: 250, 210, 0;
  --color-bg: #ffffff;
  --color-text: #111111;
  --color-border: #e0e0e0;

  /* è®¡ç®—å¾—å‡ºçš„é¢œè‰² */
  --color-primary-hover: hsl(50, 100%, 42%);
  --color-primary-light: hsla(50, 100%, 97%, 0.5);
  --color-bg-secondary: hsl(0, 0%, 97%);
  --color-bg-tertiary: hsl(0, 0%, 95%);
  --color-text-secondary: hsl(0, 0%, 40%);
  --color-text-tertiary: hsl(0, 0%, 60%);
  --color-text-placeholder: hsl(0, 0%, 73%);

  /* ç³»ç»Ÿå˜é‡ */
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Microsoft YaHei", sans-serif;
  --shadow-base: rgba(0, 0, 0, 0.07);
  --radius-base: 8px;

  /* é—´è· */
  --space-xs: 4px;
  --space-sm: 8px;
  --space-md: 16px;
  --space-lg: 24px;
  --space-xl: 32px;
  --space-2xl: 48px;

  /* åœ†è§’ */
  --radius-sm: 4px;
  --radius: var(--radius-base);
  --radius-lg: 12px;
  --radius-xl: 16px;

  /* é˜´å½± */
  --shadow-sm: 0 1px 2px var(--shadow-base);
  --shadow: 0 4px 6px var(--shadow-base);
  --shadow-lg: 0 10px 15px var(--shadow-base);
}

/* æ·±è‰²ä¸»é¢˜ */
[data-theme="dark"] {
  --color-primary: #4a90e2;
  --color-primary-rgb: 74, 144, 226;
  --color-bg: #1a1a1a;
  --color-text: #e0e0e0;
  --color-border: #404040;
  --shadow-base: rgba(0, 0, 0, 0.3);
}

/* ===== å…¨å±€æ ·å¼ ===== */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
  font-family: var(--font-family);
  background-color: var(--color-bg-secondary);
  color: var(--color-text);
  transition: background-color 0.3s ease, color 0.3s ease;
  line-height: 1.6;
}

/* ===== ä¸»é¢˜åˆ‡æ¢æŒ‰é’® ===== */
.theme-toggle {
  position: fixed;
  top: var(--space-lg);
  right: var(--space-lg);
  background: var(--color-bg);
  border: 1px solid var(--color-border);
  border-radius: var(--radius);
  padding: var(--space-sm) var(--space-md);
  cursor: pointer;
  box-shadow: var(--shadow-sm);
  transition: all 0.3s ease;
  z-index: 1000;
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  font-size: 14px;
}

.theme-toggle:hover {
  background: var(--color-bg-tertiary);
  box-shadow: var(--shadow);
}

.theme-toggle-icon {
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--color-primary);
  transition: all 0.3s ease;
}

/* ===== åŠ è½½åŠ¨ç”» ===== */
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.spinner {
  animation: spin 1s linear infinite;
}

.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
}

.loading-overlay.active {
  opacity: 1;
  visibility: visible;
}

.loading-spinner {
  width: 48px;
  height: 48px;
  border: 4px solid var(--color-bg-secondary);
  border-top: 4px solid var(--color-primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

.loading-text {
  margin-top: var(--space-lg);
  color: var(--color-text);
  font-size: 16px;
}

/* ===== ä¸»å®¹å™¨ ===== */
#app {
  max-width: 960px;
  margin: 0 auto;
  padding: var(--space-2xl) var(--space-lg);
  min-height: 100vh;
}

/* ===== å¡ç‰‡æ ·å¼ ===== */
.card {
  background: var(--color-bg);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow);
  padding: var(--space-xl);
  margin-bottom: var(--space-lg);
  transition: all 0.3s ease;
}

.card:hover {
  box-shadow: var(--shadow-lg);
}

/* ===== æ ‡é¢˜æ ·å¼ ===== */
.title {
  font-size: 28px;
  font-weight: 600;
  color: var(--color-text);
  margin-bottom: var(--space-lg);
  line-height: 1.3;
}

.subtitle {
  font-size: 20px;
  font-weight: 500;
  color: var(--color-text);
  margin-bottom: var(--space-md);
  line-height: 1.4;
}

/* ===== ä½œä¸šè§„åˆ™åŒºåŸŸ ===== */
.rules-section {
  background: var(--color-primary-light);
  border-left: 4px solid var(--color-primary);
  padding: var(--space-lg);
  border-radius: var(--radius);
  margin-bottom: var(--space-xl);
}

.rules-title {
  font-size: 16px;
  font-weight: 600;
  color: var(--color-text);
  margin-bottom: var(--space-sm);
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.rules-icon {
  width: 20px;
  height: 20px;
  background: var(--color-primary);
  border-radius: 50%;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  color: white;
}

.rules-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.rules-list li {
  padding: var(--space-xs) 0;
  color: var(--color-text-secondary);
  font-size: 14px;
  position: relative;
  padding-left: var(--space-md);
}

.rules-list li:before {
  content: "â€¢";
  color: var(--color-primary);
  position: absolute;
  left: 0;
  font-weight: bold;
}

/* ===== é¢˜ç›®åŒºåŸŸ ===== */
.question-section {
  margin-bottom: var(--space-xl);
}

.question-header {
  display: flex;
  align-items: flex-start;
  gap: var(--space-md);
  margin-bottom: var(--space-lg);
}

.question-number {
  background: var(--color-primary);
  color: white;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 16px;
  flex-shrink: 0;
}

.question-title {
  font-size: 18px;
  font-weight: 500;
  color: var(--color-text);
  line-height: 1.5;
  flex: 1;
}

/* ===== ç®€åŒ–ç‰ˆç¼–è¾‘å™¨æ ·å¼ ===== */
.simple-editor {
  min-height: 200px;
  border: 1px solid var(--color-border);
  border-radius: var(--radius);
  padding: var(--space-lg);
  background: var(--color-bg);
  color: var(--color-text);
  font-size: 16px;
  font-family: var(--font-family);
  line-height: 1.6;
  resize: vertical;
  transition: all 0.3s ease;
}

.simple-editor:focus {
  outline: none;
  border-color: var(--color-primary);
  box-shadow: 0 0 0 3px rgba(var(--color-primary-rgb), 0.1);
}

.markdown-hint {
  margin-top: var(--space-sm);
  padding: var(--space-sm);
  background: var(--color-bg-tertiary);
  border-radius: var(--radius-sm);
  font-size: 12px;
  color: var(--color-text-tertiary);
  text-align: center;
}

/* ===== æŒ‰é’®æ ·å¼ ===== */
.button-group {
  display: flex;
  gap: var(--space-md);
  justify-content: flex-end;
  margin-top: var(--space-xl);
  padding-top: var(--space-lg);
  border-top: 1px solid var(--color-border);
}

.btn {
  padding: var(--space-sm) var(--space-xl);
  border-radius: var(--radius);
  font-size: 16px;
  font-weight: 500;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
  display: inline-flex;
  align-items: center;
  gap: var(--space-sm);
}

.btn-primary {
  background: var(--color-primary);
  color: white;
}

.btn-primary:hover {
  background: var(--color-primary-hover);
  transform: translateY(-1px);
  box-shadow: var(--shadow);
}

.btn-secondary {
  background: var(--color-bg-tertiary);
  color: var(--color-text-secondary);
  border: 1px solid var(--color-border);
}

.btn-secondary:hover {
  background: var(--color-bg-secondary);
  border-color: var(--color-border);
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}

/* ===== é€šçŸ¥æ ·å¼ ===== */
.notification {
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  padding: 12px 24px;
  border-radius: var(--radius);
  color: white;
  font-weight: 500;
  z-index: 10000;
  transition: all 0.3s ease;
  box-shadow: var(--shadow);
}

.notification-success {
  background: #4caf50;
}

.notification-error {
  background: #f44336;
}

.notification-info {
  background: #2196f3;
}

/* ===== å“åº”å¼è®¾è®¡ ===== */
@media (max-width: 768px) {
  #app {
    padding: var(--space-lg) var(--space-md);
  }

  .theme-toggle {
    top: var(--space-md);
    right: var(--space-md);
    padding: var(--space-xs) var(--space-sm);
    font-size: 12px;
  }

  .card {
    padding: var(--space-lg);
  }

  .title {
    font-size: 24px;
  }

  .subtitle {
    font-size: 18px;
  }

  .question-title {
    font-size: 16px;
  }

  .button-group {
    flex-direction: column;
  }

  .btn {
    width: 100%;
    justify-content: center;
  }
}

@media (max-width: 480px) {
  #app {
    padding: var(--space-md);
  }

  .card {
    padding: var(--space-md);
    border-radius: var(--radius);
  }

  .title {
    font-size: 20px;
  }

  .rules-section {
    padding: var(--space-md);
  }

  .simple-editor {
    min-height: 150px;
    padding: var(--space-md);
  }
}
</style>
</head>
<body>
<!-- ä¸»é¢˜åˆ‡æ¢æŒ‰é’® -->
<button class="theme-toggle" id="themeToggle">
  <span class="theme-toggle-icon"></span>
  <span class="theme-text">åˆ‡æ¢ä¸»é¢˜</span>
</button>

<!-- åŠ è½½è¦†ç›–å±‚ -->
<div class="loading-overlay" id="loadingOverlay">
  <div>
    <div class="loading-spinner"></div>
    <div class="loading-text">å¤„ç†ä¸­...</div>
  </div>
</div>

<div id="app">
  <!-- æ ‡é¢˜åŒºåŸŸ -->
  <div class="card">
    <h1 class="title">ä¸€å ‚ä½œä¸šç³»ç»Ÿ</h1>
    <p style="color: var(--color-text-secondary); margin-top: 8px;">ç¦»çº¿ç‰ˆæœ¬ - æ— éœ€ç½‘ç»œè¿æ¥</p>
  </div>

  <!-- ä½œä¸šè§„åˆ™åŒºåŸŸ -->
  <div class="card rules-section">
    <div class="rules-title">
      <span class="rules-icon">!</span>
      <span>ä½œä¸šè§„åˆ™</span>
    </div>
    <ul class="rules-list">
      <li>è¯·è®¤çœŸé˜…è¯»æ¯é“é¢˜ç›®ï¼ŒæŒ‰è¦æ±‚å®Œæˆä½œä¸š</li>
      <li>æ”¯æŒç®€å•çš„æ–‡æœ¬æ ¼å¼è¾“å…¥</li>
      <li>å¯éšæ—¶ä¿å­˜è‰ç¨¿ï¼Œç¡®ä¿ä½œä¸šä¸ä¸¢å¤±</li>
      <li>å®Œæˆåè¯·ç‚¹å‡»æäº¤æŒ‰é’®</li>
    </ul>
  </div>

  <!-- é¢˜ç›®1 -->
  <div class="card question-section">
    <div class="question-header">
      <span class="question-number">1</span>
      <h2 class="question-title">è¯·æè¿°ä½ å¯¹åˆ›ä¸šçš„ç†è§£ï¼Œä»¥åŠä½ å¸Œæœ›åœ¨åˆ›ä¸šè¿‡ç¨‹ä¸­å­¦åˆ°ä»€ä¹ˆï¼Ÿ</h2>
    </div>
    <textarea class="simple-editor" placeholder="è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ..." id="answer1"></textarea>
  </div>

  <!-- é¢˜ç›®2 -->
  <div class="card question-section">
    <div class="question-header">
      <span class="question-number">2</span>
      <h2 class="question-title">å¦‚æœä½ æœ‰ä¸€ä¸ªåˆ›ä¸šæƒ³æ³•ï¼Œè¯·ç®€è¿°è¿™ä¸ªæƒ³æ³•çš„æ ¸å¿ƒä»·å€¼ä¸»å¼ ã€‚</h2>
    </div>
    <textarea class="simple-editor" placeholder="è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ..." id="answer2"></textarea>
  </div>

  <!-- é¢˜ç›®3 -->
  <div class="card question-section">
    <div class="question-header">
      <span class="question-number">3</span>
      <h2 class="question-title">ä½ è®¤ä¸ºåœ¨åˆ›ä¸šè¿‡ç¨‹ä¸­ï¼Œæœ€é‡è¦çš„ä¸‰ä¸ªå› ç´ æ˜¯ä»€ä¹ˆï¼Ÿè¯·è¯´æ˜åŸå› ã€‚</h2>
    </div>
    <textarea class="simple-editor" placeholder="è¯·è¾“å…¥ä½ çš„ç­”æ¡ˆ..." id="answer3"></textarea>
  </div>

  <!-- æŒ‰é’®ç»„ -->
  <div class="card">
    <div class="button-group">
      <button class="btn btn-secondary" id="saveBtn">
        <span>ğŸ’¾</span>
        <span>æš‚å­˜è‰ç¨¿</span>
      </button>
      <button class="btn btn-primary" id="submitBtn">
        <span>ğŸ“¤</span>
        <span>æäº¤ä½œä¸š</span>
      </button>
    </div>
  </div>
</div>

<script>
// ===== ä¸»é¢˜ç®¡ç† =====
class ThemeManager {
  constructor() {
    this.currentTheme = this.getStoredTheme() || this.detectSystemTheme();
    this.init();
  }

  getStoredTheme() {
    try {
      return localStorage.getItem('theme');
    } catch (e) {
      return null;
    }
  }

  detectSystemTheme() {
    try {
      return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    } catch (e) {
      return 'light';
    }
  }

  init() {
    this.applyTheme(this.currentTheme);
    this.bindEvents();
  }

  applyTheme(theme) {
    document.documentElement.setAttribute('data-theme', theme);
    this.currentTheme = theme;

    try {
      localStorage.setItem('theme', theme);
    } catch (e) {
      // å¿½ç•¥localStorageé”™è¯¯
    }

    const themeText = document.querySelector('.theme-text');
    if (themeText) {
      themeText.textContent = theme === 'dark' ? 'äº®è‰²æ¨¡å¼' : 'æ·±è‰²æ¨¡å¼';
    }
  }

  bindEvents() {
    const themeToggle = document.getElementById('themeToggle');
    if (themeToggle) {
      themeToggle.addEventListener('click', () => {
        this.toggleTheme();
      });
    }
  }

  toggleTheme() {
    this.applyTheme(this.currentTheme === 'dark' ? 'light' : 'dark');
  }
}

// ===== ä½œä¸šç®¡ç†å™¨ =====
class HomeworkManager {
  constructor() {
    this.questions = [
      { id: 1, element: 'answer1' },
      { id: 2, element: 'answer2' },
      { id: 3, element: 'answer3' }
    ];
    this.init();
  }

  init() {
    this.bindEvents();
    this.loadDraft();
    this.startAutoSave();
  }

  bindEvents() {
    // æš‚å­˜æŒ‰é’®
    const saveBtn = document.getElementById('saveBtn');
    if (saveBtn) {
      saveBtn.addEventListener('click', () => {
        this.saveDraft();
      });
    }

    // æäº¤æŒ‰é’®
    const submitBtn = document.getElementById('submitBtn');
    if (submitBtn) {
      submitBtn.addEventListener('click', () => {
        this.submit();
      });
    }

    // ç›‘å¬è¾“å…¥å˜åŒ–
    this.questions.forEach(q => {
      const element = document.getElementById(q.element);
      if (element) {
        element.addEventListener('input', () => {
          this.markAsChanged();
        });
      }
    });
  }

  markAsChanged() {
    // æ ‡è®°å†…å®¹å·²æ”¹å˜
    this.hasChanges = true;
  }

  getContent() {
    const content = {};
    this.questions.forEach(q => {
      const element = document.getElementById(q.element);
      if (element) {
        content[q.id] = element.value;
      }
    });
    return content;
  }

  saveDraft() {
    try {
      const content = this.getContent();
      const draftData = {
        timestamp: Date.now(),
        content: content
      };

      localStorage.setItem('homework_draft', JSON.stringify(draftData));
      this.showNotification('è‰ç¨¿å·²ä¿å­˜', 'success');
      this.hasChanges = false;
    } catch (e) {
      console.error('ä¿å­˜è‰ç¨¿å¤±è´¥:', e);
      this.showNotification('ä¿å­˜å¤±è´¥', 'error');
    }
  }

  loadDraft() {
    try {
      const draft = localStorage.getItem('homework_draft');
      if (!draft) return;

      const draftData = JSON.parse(draft);

      // æ£€æŸ¥è‰ç¨¿æ˜¯å¦è¿‡æœŸï¼ˆè¶…è¿‡7å¤©ï¼‰
      const maxAge = 7 * 24 * 60 * 60 * 1000; // 7å¤©
      if (Date.now() - draftData.timestamp > maxAge) {
        localStorage.removeItem('homework_draft');
        return;
      }

      // æ¢å¤è‰ç¨¿
      this.questions.forEach(q => {
        const element = document.getElementById(q.element);
        if (element && draftData.content[q.id]) {
          element.value = draftData.content[q.id];
        }
      });

      this.showNotification('è‰ç¨¿å·²æ¢å¤', 'info');
    } catch (e) {
      console.error('åŠ è½½è‰ç¨¿å¤±è´¥:', e);
    }
  }

  startAutoSave() {
    // æ¯åˆ†é’Ÿè‡ªåŠ¨ä¿å­˜
    setInterval(() => {
      if (this.hasChanges) {
        this.saveDraft();
      }
    }, 60000);
  }

  submit() {
    // éªŒè¯æ‰€æœ‰é¢˜ç›®éƒ½å·²å¡«å†™
    let allAnswered = true;
    this.questions.forEach(q => {
      const element = document.getElementById(q.element);
      if (element && !element.value.trim()) {
        allAnswered = false;
      }
    });

    if (!allAnswered) {
      if (!confirm('è¿˜æœ‰é¢˜ç›®æœªå®Œæˆï¼Œç¡®å®šè¦æäº¤å—ï¼Ÿ')) {
        return;
      }
    }

    // æ”¶é›†ç­”æ¡ˆ
    const answers = this.getContent();

    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    const loadingOverlay = document.getElementById('loadingOverlay');
    if (loadingOverlay) {
      loadingOverlay.classList.add('active');
    }

    const submitBtn = document.getElementById('submitBtn');
    if (submitBtn) {
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<span>â³</span><span>æäº¤ä¸­...</span>';
    }

    // æ¨¡æ‹Ÿæäº¤
    setTimeout(() => {
      // æ¸…é™¤è‰ç¨¿
      try {
        localStorage.removeItem('homework_draft');
      } catch (e) {
        console.error('æ¸…ç†è‰ç¨¿å¤±è´¥:', e);
      }

      // éšè—åŠ è½½çŠ¶æ€
      if (loadingOverlay) {
        loadingOverlay.classList.remove('active');
      }

      if (submitBtn) {
        submitBtn.disabled = false;
        submitBtn.innerHTML = '<span>ğŸ“¤</span><span>æäº¤ä½œä¸š</span>';
      }

      this.showNotification('ä½œä¸šæäº¤æˆåŠŸï¼', 'success');
      console.log('æäº¤çš„ç­”æ¡ˆ:', answers);

      // å¯é€‰ï¼šæ¸…ç©ºè¾“å…¥æ¡†
      if (confirm('ä½œä¸šæäº¤æˆåŠŸï¼æ˜¯å¦æ¸…ç©ºç­”æ¡ˆï¼Ÿ')) {
        this.questions.forEach(q => {
          const element = document.getElementById(q.element);
          if (element) {
            element.value = '';
          }
        });
      }
    }, 2000);
  }

  showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.textContent = message;
    notification.style.cssText = `
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 12px 24px;
      border-radius: 8px;
      color: white;
      font-weight: 500;
      z-index: 10000;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    `;

    document.body.appendChild(notification);

    // 3ç§’åè‡ªåŠ¨æ¶ˆå¤±
    setTimeout(() => {
      notification.style.opacity = '0';
      setTimeout(() => {
        if (document.body.contains(notification)) {
          document.body.removeChild(notification);
        }
      }, 300);
    }, 3000);
  }
}

// ===== åˆå§‹åŒ–åº”ç”¨ =====
document.addEventListener('DOMContentLoaded', () => {
  // åˆå§‹åŒ–ä¸»é¢˜ç®¡ç†å™¨
  const themeManager = new ThemeManager();

  // åˆå§‹åŒ–ä½œä¸šç®¡ç†å™¨
  const homeworkManager = new HomeworkManager();

  console.log('ä½œä¸šç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ - ç¦»çº¿ç‰ˆæœ¬');
});
</script>
</body>
</html>